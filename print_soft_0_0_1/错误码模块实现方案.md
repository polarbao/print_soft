# Motion Control SDK é”™è¯¯ç æ¨¡å—å®ç°æ–¹æ¡ˆ

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**åˆ›å»ºæ—¥æœŸ**: 2026-01-20  
**é€‚ç”¨é¡¹ç›®**: Motion Control SDK v0.0.1+

---

## ğŸ“‹ ç›®å½•

1. [æ¦‚è¿°](#1-æ¦‚è¿°)
2. [é”™è¯¯ç è®¾è®¡åŸåˆ™](#2-é”™è¯¯ç è®¾è®¡åŸåˆ™)
3. [é”™è¯¯ç å®šä¹‰](#3-é”™è¯¯ç å®šä¹‰)
4. [å®ç°æ–¹æ¡ˆ](#4-å®ç°æ–¹æ¡ˆ)
5. [ä½¿ç”¨ç¤ºä¾‹](#5-ä½¿ç”¨ç¤ºä¾‹)
6. [é›†æˆæŒ‡å—](#6-é›†æˆæŒ‡å—)
7. [å¤šè¯­è¨€æ”¯æŒ](#7-å¤šè¯­è¨€æ”¯æŒ)
8. [æµ‹è¯•æ–¹æ¡ˆ](#8-æµ‹è¯•æ–¹æ¡ˆ)

---

## 1. æ¦‚è¿°

### 1.1 è®¾è®¡ç›®æ ‡

å»ºç«‹ä¸€å¥—ç»Ÿä¸€ã€æ¸…æ™°ã€å¯æ‰©å±•çš„é”™è¯¯ç ä½“ç³»ï¼Œç”¨äºï¼š
- âœ… ç²¾ç¡®å®šä½é”™è¯¯æ¥æºå’Œç±»å‹
- âœ… æ”¯æŒå¤šè¯­è¨€é”™è¯¯æ¶ˆæ¯
- âœ… ä¾¿äºæ—¥å¿—åˆ†æå’Œé—®é¢˜è¿½è¸ª
- âœ… æä¾›ä¸°å¯Œçš„é”™è¯¯ä¸Šä¸‹æ–‡ä¿¡æ¯

### 1.2 æ ¸å¿ƒç‰¹æ€§

- **å±‚æ¬¡åŒ–è®¾è®¡**: æŒ‰ç±»åˆ«-æ¨¡å—-å…·ä½“é”™è¯¯ä¸‰çº§åˆ†ç±»
- **è¯­ä¹‰åŒ–å‘½å**: é”™è¯¯ç åç§°ç›´è§‚æ˜“æ‡‚
- **å›½é™…åŒ–æ”¯æŒ**: å†…ç½®å¤šè¯­è¨€é”™è¯¯æ¶ˆæ¯
- **å¯æ‰©å±•æ€§**: é¢„ç•™æ‰©å±•ç©ºé—´ï¼Œæ–¹ä¾¿åç»­æ·»åŠ 

---

## 2. é”™è¯¯ç è®¾è®¡åŸåˆ™

### 2.1 ç¼–ç è§„åˆ™

```
é”™è¯¯ç æ ¼å¼: 0xCCMMEEEE
â”œâ”€ CC:   ç±»åˆ«ç  (Category, 2ä½)
â”œâ”€ MM:   æ¨¡å—ç  (Module, 2ä½)
â””â”€ EEEE: å…·ä½“é”™è¯¯ (Error, 4ä½)

ç¤ºä¾‹: 0x01020003
      ^^ ç±»åˆ«: 01 = ä¸€èˆ¬é”™è¯¯
         ^^ æ¨¡å—: 02 = è¿æ¥æ¨¡å—
            ^^^^ é”™è¯¯: 0003 = è¿æ¥è¶…æ—¶
```

### 2.2 ç±»åˆ«ç å®šä¹‰

| ç±»åˆ«ç  | åç§° | è¯´æ˜ | èŒƒå›´ |
|--------|------|------|------|
| `0x00` | Success | æˆåŠŸ | 0x00000000 |
| `0x01` | GeneralError | ä¸€èˆ¬é”™è¯¯ | 0x01000000 - 0x01FFFFFF |
| `0x02` | SystemError | ç³»ç»Ÿé”™è¯¯ | 0x02000000 - 0x02FFFFFF |
| `0x03` | HardwareError | ç¡¬ä»¶é”™è¯¯ | 0x03000000 - 0x03FFFFFF |
| `0x04` | ProtocolError | åè®®é”™è¯¯ | 0x04000000 - 0x04FFFFFF |
| `0x05` | UserError | ç”¨æˆ·é”™è¯¯ | 0x05000000 - 0x05FFFFFF |

### 2.3 æ¨¡å—ç å®šä¹‰

| æ¨¡å—ç  | åç§° | è¯´æ˜ | èŒƒå›´ |
|--------|------|------|------|
| `0x00` | Core | æ ¸å¿ƒæ¨¡å— | 0xXX00XXXX |
| `0x01` | Init | åˆå§‹åŒ–æ¨¡å— | 0xXX01XXXX |
| `0x02` | Connection | è¿æ¥æ¨¡å— | 0xXX02XXXX |
| `0x03` | Motion | è¿åŠ¨æ§åˆ¶æ¨¡å— | 0xXX03XXXX |
| `0x04` | Print | æ‰“å°æ§åˆ¶æ¨¡å— | 0xXX04XXXX |
| `0x05` | Config | é…ç½®æ¨¡å— | 0xXX05XXXX |
| `0x06` | Protocol | åè®®æ¨¡å— | 0xXX06XXXX |
| `0x07` | Hardware | ç¡¬ä»¶æ¨¡å— | 0xXX07XXXX |

---

## 3. é”™è¯¯ç å®šä¹‰

### 3.1 å¤´æ–‡ä»¶å®šä¹‰

```cpp
// SDKErrorCode.h
#ifndef SDK_ERROR_CODE_H
#define SDK_ERROR_CODE_H

#include <QtGlobal>
#include <QString>
#include <QMap>

namespace MotionSDK {

/**
 * @brief SDK é”™è¯¯ç æšä¸¾
 * @details æ ¼å¼: 0xCCMMEEEE (ç±»åˆ«-æ¨¡å—-å…·ä½“é”™è¯¯)
 */
enum class SDKError : quint32 {
    // ==================== æˆåŠŸ (0x00) ====================
    Success = 0x00000000,  ///< æ“ä½œæˆåŠŸ
    
    // ==================== ä¸€èˆ¬é”™è¯¯ - æ ¸å¿ƒæ¨¡å— (0x0100) ====================
    UnknownError = 0x01000001,           ///< æœªçŸ¥é”™è¯¯
    NotImplemented = 0x01000002,         ///< åŠŸèƒ½æœªå®ç°
    OperationCancelled = 0x01000003,     ///< æ“ä½œè¢«å–æ¶ˆ
    
    // ==================== ä¸€èˆ¬é”™è¯¯ - åˆå§‹åŒ–æ¨¡å— (0x0101) ====================
    InitFailed = 0x01010001,             ///< åˆå§‹åŒ–å¤±è´¥
    AlreadyInitialized = 0x01010002,     ///< å·²ç»åˆå§‹åŒ–
    NotInitialized = 0x01010003,         ///< æœªåˆå§‹åŒ–
    LogInitFailed = 0x01010004,          ///< æ—¥å¿—ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥
    ManagerInitFailed = 0x01010005,      ///< ç®¡ç†å™¨åˆå§‹åŒ–å¤±è´¥
    ConfigLoadFailed = 0x01010006,       ///< é…ç½®åŠ è½½å¤±è´¥
    
    // ==================== ä¸€èˆ¬é”™è¯¯ - è¿æ¥æ¨¡å— (0x0102) ====================
    NotConnected = 0x01020001,           ///< è®¾å¤‡æœªè¿æ¥
    AlreadyConnected = 0x01020002,       ///< è®¾å¤‡å·²è¿æ¥
    ConnectionFailed = 0x01020003,       ///< è¿æ¥å¤±è´¥
    ConnectionTimeout = 0x01020004,      ///< è¿æ¥è¶…æ—¶
    ConnectionLost = 0x01020005,         ///< è¿æ¥ä¸¢å¤±
    HeartbeatTimeout = 0x01020006,       ///< å¿ƒè·³è¶…æ—¶
    DisconnectFailed = 0x01020007,       ///< æ–­å¼€è¿æ¥å¤±è´¥
    
    // ==================== ä¸€èˆ¬é”™è¯¯ - è¿åŠ¨æ§åˆ¶æ¨¡å— (0x0103) ====================
    MoveCommandFailed = 0x01030001,      ///< ç§»åŠ¨å‘½ä»¤å¤±è´¥
    PositionOutOfRange = 0x01030002,     ///< ä½ç½®è¶…å‡ºèŒƒå›´
    SpeedOutOfRange = 0x01030003,        ///< é€Ÿåº¦è¶…å‡ºèŒƒå›´
    AccelerationOutOfRange = 0x01030004, ///< åŠ é€Ÿåº¦è¶…å‡ºèŒƒå›´
    AxisBusy = 0x01030005,               ///< è½´æ­£å¿™ï¼ˆè¿åŠ¨ä¸­ï¼‰
    AxisNotHomed = 0x01030006,           ///< è½´æœªå›åŸç‚¹
    HomeCommandFailed = 0x01030007,      ///< å›åŸç‚¹å‘½ä»¤å¤±è´¥
    EmergencyStop = 0x01030008,          ///< ç´§æ€¥åœæ­¢
    MotionBlocked = 0x01030009,          ///< è¿åŠ¨è¢«é˜»å¡
    
    // ==================== ä¸€èˆ¬é”™è¯¯ - æ‰“å°æ§åˆ¶æ¨¡å— (0x0104) ====================
    PrintStartFailed = 0x01040001,       ///< å¯åŠ¨æ‰“å°å¤±è´¥
    PrintPauseFailed = 0x01040002,       ///< æš‚åœæ‰“å°å¤±è´¥
    PrintResumeFailed = 0x01040003,      ///< æ¢å¤æ‰“å°å¤±è´¥
    PrintStopFailed = 0x01040004,        ///< åœæ­¢æ‰“å°å¤±è´¥
    PrintNotStarted = 0x01040005,        ///< æ‰“å°æœªå¯åŠ¨
    PrintAlreadyRunning = 0x01040006,    ///< æ‰“å°å·²åœ¨è¿è¡Œ
    PrintDataInvalid = 0x01040007,       ///< æ‰“å°æ•°æ®æ— æ•ˆ
    
    // ==================== ä¸€èˆ¬é”™è¯¯ - é…ç½®æ¨¡å— (0x0105) ====================
    InvalidConfig = 0x01050001,          ///< é…ç½®æ— æ•ˆ
    InvalidIP = 0x01050002,              ///< IP åœ°å€æ— æ•ˆ
    InvalidPort = 0x01050003,            ///< ç«¯å£å·æ— æ•ˆ
    InvalidStartPosition = 0x01050004,   ///< èµ·å§‹ä½ç½®æ— æ•ˆ
    InvalidEndPosition = 0x01050005,     ///< ç»“æŸä½ç½®æ— æ•ˆ
    InvalidPrintArea = 0x01050006,       ///< æ‰“å°åŒºåŸŸæ— æ•ˆ
    InvalidSpeed = 0x01050007,           ///< é€Ÿåº¦å‚æ•°æ— æ•ˆ
    InvalidAcceleration = 0x01050008,    ///< åŠ é€Ÿåº¦å‚æ•°æ— æ•ˆ
    ConfigSaveFailed = 0x01050009,       ///< é…ç½®ä¿å­˜å¤±è´¥
    
    // ==================== ä¸€èˆ¬é”™è¯¯ - åè®®æ¨¡å— (0x0106) ====================
    CommandTimeout = 0x01060001,         ///< å‘½ä»¤è¶…æ—¶
    CommandAckFailed = 0x01060002,       ///< å‘½ä»¤åº”ç­”å¤±è´¥
    InvalidCommand = 0x01060003,         ///< æ— æ•ˆå‘½ä»¤
    InvalidDataLength = 0x01060004,      ///< æ•°æ®é•¿åº¦æ— æ•ˆ
    CRCCheckFailed = 0x01060005,         ///< CRC æ ¡éªŒå¤±è´¥
    PacketFormatError = 0x01060006,      ///< æ•°æ®åŒ…æ ¼å¼é”™è¯¯
    PacketHeadError = 0x01060007,        ///< æ•°æ®åŒ…åŒ…å¤´é”™è¯¯
    
    // ==================== ç³»ç»Ÿé”™è¯¯ (0x02) ====================
    OutOfMemory = 0x02000001,            ///< å†…å­˜ä¸è¶³
    FileNotFound = 0x02000002,           ///< æ–‡ä»¶æœªæ‰¾åˆ°
    FileOpenFailed = 0x02000003,         ///< æ–‡ä»¶æ‰“å¼€å¤±è´¥
    FileWriteFailed = 0x02000004,        ///< æ–‡ä»¶å†™å…¥å¤±è´¥
    FileReadFailed = 0x02000005,         ///< æ–‡ä»¶è¯»å–å¤±è´¥
    ThreadCreateFailed = 0x02000006,     ///< çº¿ç¨‹åˆ›å»ºå¤±è´¥
    MutexLockFailed = 0x02000007,        ///< äº’æ–¥é”å¤±è´¥
    
    // ==================== ç³»ç»Ÿé”™è¯¯ - TCP/IP (0x0201) ====================
    SocketCreateFailed = 0x02010001,     ///< Socket åˆ›å»ºå¤±è´¥
    SocketBindFailed = 0x02010002,       ///< Socket ç»‘å®šå¤±è´¥
    SocketConnectFailed = 0x02010003,    ///< Socket è¿æ¥å¤±è´¥
    SocketSendFailed = 0x02010004,       ///< Socket å‘é€å¤±è´¥
    SocketReceiveFailed = 0x02010005,    ///< Socket æ¥æ”¶å¤±è´¥
    NetworkUnreachable = 0x02010006,     ///< ç½‘ç»œä¸å¯è¾¾
    
    // ==================== ç¡¬ä»¶é”™è¯¯ (0x03) ====================
    DeviceNotFound = 0x03000001,         ///< è®¾å¤‡æœªæ‰¾åˆ°
    DeviceNotResponding = 0x03000002,    ///< è®¾å¤‡æ— å“åº”
    DeviceError = 0x03000003,            ///< è®¾å¤‡é”™è¯¯
    FirmwareError = 0x03000004,          ///< å›ºä»¶é”™è¯¯
    MotorError = 0x03000005,             ///< ç”µæœºé”™è¯¯
    SensorError = 0x03000006,            ///< ä¼ æ„Ÿå™¨é”™è¯¯
    LimitSwitchTriggered = 0x03000007,   ///< é™ä½å¼€å…³è§¦å‘
    PowerSupplyError = 0x03000008,       ///< ç”µæºé”™è¯¯
    OverTemperature = 0x03000009,        ///< æ¸©åº¦è¿‡é«˜
    
    // ==================== åè®®é”™è¯¯ (0x04) ====================
    ProtocolVersionMismatch = 0x04000001,///< åè®®ç‰ˆæœ¬ä¸åŒ¹é…
    UnknownProtocolCommand = 0x04000002, ///< æœªçŸ¥åè®®å‘½ä»¤
    ProtocolParseError = 0x04000003,     ///< åè®®è§£æé”™è¯¯
    
    // ==================== ç”¨æˆ·é”™è¯¯ (0x05) ====================
    InvalidParameter = 0x05000001,       ///< å‚æ•°æ— æ•ˆ
    InvalidOperation = 0x05000002,       ///< æ“ä½œæ— æ•ˆ
    OperationNotAllowed = 0x05000003,    ///< æ“ä½œä¸å…è®¸
    PermissionDenied = 0x05000004,       ///< æƒé™æ‹’ç»
};

/**
 * @brief é”™è¯¯ä¿¡æ¯ç»“æ„ä½“
 */
struct ErrorInfo {
    SDKError code;                       ///< é”™è¯¯ç 
    QString name;                        ///< é”™è¯¯åç§°ï¼ˆè‹±æ–‡ï¼‰
    QString message_zh;                  ///< é”™è¯¯æ¶ˆæ¯ï¼ˆä¸­æ–‡ï¼‰
    QString message_en;                  ///< é”™è¯¯æ¶ˆæ¯ï¼ˆè‹±æ–‡ï¼‰
    QString suggestion_zh;               ///< è§£å†³å»ºè®®ï¼ˆä¸­æ–‡ï¼‰
    QString suggestion_en;               ///< è§£å†³å»ºè®®ï¼ˆè‹±æ–‡ï¼‰
    
    QString getMessage(const QString& locale = "zh_CN") const {
        return (locale == "zh_CN") ? message_zh : message_en;
    }
    
    QString getSuggestion(const QString& locale = "zh_CN") const {
        return (locale == "zh_CN") ? suggestion_zh : suggestion_en;
    }
};

/**
 * @brief é”™è¯¯ç ç®¡ç†å™¨
 */
class SDKErrorManager {
public:
    /**
     * @brief è·å–å•ä¾‹å®ä¾‹
     */
    static SDKErrorManager* instance();
    
    /**
     * @brief è·å–é”™è¯¯ä¿¡æ¯
     * @param error é”™è¯¯ç 
     * @return é”™è¯¯ä¿¡æ¯ç»“æ„ä½“
     */
    ErrorInfo getErrorInfo(SDKError error) const;
    
    /**
     * @brief è·å–é”™è¯¯æ¶ˆæ¯
     * @param error é”™è¯¯ç 
     * @param locale è¯­è¨€ä»£ç ï¼ˆ"zh_CN" æˆ– "en_US"ï¼‰
     * @return æœ¬åœ°åŒ–çš„é”™è¯¯æ¶ˆæ¯
     */
    QString getErrorMessage(SDKError error, const QString& locale = "zh_CN") const;
    
    /**
     * @brief è·å–é”™è¯¯å»ºè®®
     * @param error é”™è¯¯ç 
     * @param locale è¯­è¨€ä»£ç 
     * @return æœ¬åœ°åŒ–çš„è§£å†³å»ºè®®
     */
    QString getErrorSuggestion(SDKError error, const QString& locale = "zh_CN") const;
    
    /**
     * @brief åˆ¤æ–­æ˜¯å¦ä¸ºæˆåŠŸ
     */
    static bool isSuccess(SDKError error) {
        return error == SDKError::Success;
    }
    
    /**
     * @brief è·å–é”™è¯¯ç±»åˆ«
     */
    static quint8 getCategory(SDKError error) {
        return static_cast<quint32>(error) >> 24;
    }
    
    /**
     * @brief è·å–é”™è¯¯æ¨¡å—
     */
    static quint8 getModule(SDKError error) {
        return (static_cast<quint32>(error) >> 16) & 0xFF;
    }
    
    /**
     * @brief æ ¼å¼åŒ–é”™è¯¯ç ï¼ˆåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼‰
     */
    static QString formatErrorCode(SDKError error) {
        return QString("0x%1").arg(static_cast<quint32>(error), 8, 16, QChar('0')).toUpper();
    }
    
private:
    SDKErrorManager();
    void initErrorTable();
    
    QMap<SDKError, ErrorInfo> m_errorTable;
    QString m_currentLocale{"zh_CN"};
};

} // namespace MotionSDK

// å£°æ˜ä¸º Qt å…ƒç±»å‹ï¼ˆç”¨äºä¿¡å·æ§½ï¼‰
Q_DECLARE_METATYPE(MotionSDK::SDKError)

#endif // SDK_ERROR_CODE_H
```

---

## 4. å®ç°æ–¹æ¡ˆ

### 4.1 é”™è¯¯ç®¡ç†å™¨å®ç°

```cpp
// SDKErrorCode.cpp
#include "SDKErrorCode.h"
#include <QMutex>
#include <QMutexLocker>

namespace MotionSDK {

// å•ä¾‹å®ç°
SDKErrorManager* SDKErrorManager::instance()
{
    static SDKErrorManager manager;
    return &manager;
}

SDKErrorManager::SDKErrorManager()
{
    initErrorTable();
}

void SDKErrorManager::initErrorTable()
{
    // ==================== æˆåŠŸ ====================
    m_errorTable[SDKError::Success] = {
        SDKError::Success,
        "Success",
        "æ“ä½œæˆåŠŸ",
        "Operation succeeded",
        "",
        ""
    };
    
    // ==================== åˆå§‹åŒ–é”™è¯¯ ====================
    m_errorTable[SDKError::NotInitialized] = {
        SDKError::NotInitialized,
        "NotInitialized",
        "SDK æœªåˆå§‹åŒ–",
        "SDK not initialized",
        "è¯·å…ˆè°ƒç”¨ MC_Init() è¿›è¡Œåˆå§‹åŒ–",
        "Please call MC_Init() first"
    };
    
    m_errorTable[SDKError::AlreadyInitialized] = {
        SDKError::AlreadyInitialized,
        "AlreadyInitialized",
        "SDK å·²ç»åˆå§‹åŒ–",
        "SDK already initialized",
        "æ— éœ€é‡å¤åˆå§‹åŒ–",
        "No need to initialize again"
    };
    
    m_errorTable[SDKError::LogInitFailed] = {
        SDKError::LogInitFailed,
        "LogInitFailed",
        "æ—¥å¿—ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥",
        "Log system initialization failed",
        "æ£€æŸ¥æ—¥å¿—ç›®å½•æ˜¯å¦æœ‰å†™æƒé™",
        "Check if log directory has write permission"
    };
    
    // ==================== è¿æ¥é”™è¯¯ ====================
    m_errorTable[SDKError::NotConnected] = {
        SDKError::NotConnected,
        "NotConnected",
        "è®¾å¤‡æœªè¿æ¥",
        "Device not connected",
        "è¯·å…ˆè°ƒç”¨ MC_Connect2Dev() è¿æ¥è®¾å¤‡",
        "Please call MC_Connect2Dev() first"
    };
    
    m_errorTable[SDKError::AlreadyConnected] = {
        SDKError::AlreadyConnected,
        "AlreadyConnected",
        "è®¾å¤‡å·²è¿æ¥",
        "Device already connected",
        "æ— éœ€é‡å¤è¿æ¥",
        "No need to connect again"
    };
    
    m_errorTable[SDKError::ConnectionTimeout] = {
        SDKError::ConnectionTimeout,
        "ConnectionTimeout",
        "è¿æ¥è¶…æ—¶",
        "Connection timeout",
        "æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œè®¾å¤‡ç”µæºï¼Œç¡®è®¤ IP/ç«¯å£æ­£ç¡®",
        "Check network, device power, and verify IP/port"
    };
    
    m_errorTable[SDKError::HeartbeatTimeout] = {
        SDKError::HeartbeatTimeout,
        "HeartbeatTimeout",
        "å¿ƒè·³è¶…æ—¶ï¼ˆè®¾å¤‡æ— å“åº”ï¼‰",
        "Heartbeat timeout (device not responding)",
        "è®¾å¤‡å¯èƒ½æ–­ç”µæˆ–ç½‘ç»œä¸­æ–­ï¼Œè¯·é‡æ–°è¿æ¥",
        "Device may be powered off or network interrupted"
    };
    
    // ==================== è¿åŠ¨æ§åˆ¶é”™è¯¯ ====================
    m_errorTable[SDKError::PositionOutOfRange] = {
        SDKError::PositionOutOfRange,
        "PositionOutOfRange",
        "ç›®æ ‡ä½ç½®è¶…å‡ºè¿åŠ¨èŒƒå›´",
        "Target position out of range",
        "æ£€æŸ¥åæ ‡å€¼æ˜¯å¦åœ¨é™ä½èŒƒå›´å†…",
        "Check if coordinates are within limits"
    };
    
    m_errorTable[SDKError::AxisBusy] = {
        SDKError::AxisBusy,
        "AxisBusy",
        "è½´æ­£åœ¨è¿åŠ¨ä¸­",
        "Axis is busy (moving)",
        "ç­‰å¾…å½“å‰è¿åŠ¨å®Œæˆåå†æ“ä½œ",
        "Wait for current motion to complete"
    };
    
    m_errorTable[SDKError::EmergencyStop] = {
        SDKError::EmergencyStop,
        "EmergencyStop",
        "ç´§æ€¥åœæ­¢å·²è§¦å‘",
        "Emergency stop triggered",
        "å¤ä½ç´§æ€¥åœæ­¢å¼€å…³åé‡æ–°å¯åŠ¨",
        "Reset emergency stop switch and restart"
    };
    
    // ==================== é…ç½®é”™è¯¯ ====================
    m_errorTable[SDKError::InvalidIP] = {
        SDKError::InvalidIP,
        "InvalidIP",
        "IP åœ°å€æ ¼å¼é”™è¯¯",
        "Invalid IP address format",
        "è¯·ä½¿ç”¨æ­£ç¡®çš„ IPv4 åœ°å€æ ¼å¼ï¼ˆä¾‹å¦‚: 192.168.1.100ï¼‰",
        "Use correct IPv4 format (e.g., 192.168.1.100)"
    };
    
    m_errorTable[SDKError::InvalidPort] = {
        SDKError::InvalidPort,
        "InvalidPort",
        "ç«¯å£å·æ— æ•ˆ",
        "Invalid port number",
        "ç«¯å£å·åº”åœ¨ 1024-65535 èŒƒå›´å†…",
        "Port should be in range 1024-65535"
    };
    
    m_errorTable[SDKError::InvalidPrintArea] = {
        SDKError::InvalidPrintArea,
        "InvalidPrintArea",
        "æ‰“å°åŒºåŸŸè®¾ç½®é”™è¯¯ï¼ˆèµ·ç‚¹åº”å°äºç»ˆç‚¹ï¼‰",
        "Invalid print area (start should be less than end)",
        "æ£€æŸ¥èµ·ç‚¹å’Œç»ˆç‚¹åæ ‡è®¾ç½®",
        "Check start and end coordinates"
    };
    
    // ==================== åè®®é”™è¯¯ ====================
    m_errorTable[SDKError::CommandTimeout] = {
        SDKError::CommandTimeout,
        "CommandTimeout",
        "å‘½ä»¤è¶…æ—¶ï¼ˆè®¾å¤‡æœªå“åº”ï¼‰",
        "Command timeout (no response)",
        "è®¾å¤‡å¯èƒ½æ­£å¿™ï¼Œç¨åé‡è¯•æˆ–æ£€æŸ¥è®¾å¤‡çŠ¶æ€",
        "Device may be busy, retry later or check status"
    };
    
    m_errorTable[SDKError::CRCCheckFailed] = {
        SDKError::CRCCheckFailed,
        "CRCCheckFailed",
        "æ•°æ®æ ¡éªŒå¤±è´¥",
        "CRC check failed",
        "æ•°æ®ä¼ è¾“é”™è¯¯ï¼Œè‡ªåŠ¨é‡å‘æˆ–æ£€æŸ¥ç½‘ç»œè´¨é‡",
        "Data transmission error, auto-retry or check network"
    };
    
    // ==================== ç¡¬ä»¶é”™è¯¯ ====================
    m_errorTable[SDKError::LimitSwitchTriggered] = {
        SDKError::LimitSwitchTriggered,
        "LimitSwitchTriggered",
        "è§¦å‘é™ä½å¼€å…³",
        "Limit switch triggered",
        "è½´å·²åˆ°è¾¾é™ä½ä½ç½®ï¼Œè¯·å›åŸç‚¹åå†æ“ä½œ",
        "Axis reached limit, go home first"
    };
    
    m_errorTable[SDKError::OverTemperature] = {
        SDKError::OverTemperature,
        "OverTemperature",
        "æ¸©åº¦è¿‡é«˜",
        "Over temperature",
        "åœæ­¢è®¾å¤‡è¿è¡Œï¼Œç­‰å¾…å†·å´åå†ä½¿ç”¨",
        "Stop operation and wait for cooling"
    };
    
    // æ·»åŠ æ›´å¤šé”™è¯¯ä¿¡æ¯...
}

ErrorInfo SDKErrorManager::getErrorInfo(SDKError error) const
{
    if (m_errorTable.contains(error)) {
        return m_errorTable[error];
    }
    
    // è¿”å›é»˜è®¤é”™è¯¯ä¿¡æ¯
    return {
        error,
        "UnknownError",
        QString("æœªçŸ¥é”™è¯¯ (0x%1)").arg(static_cast<quint32>(error), 8, 16, QChar('0')),
        QString("Unknown error (0x%1)").arg(static_cast<quint32>(error), 8, 16, QChar('0')),
        "è¯·è”ç³»æŠ€æœ¯æ”¯æŒ",
        "Please contact technical support"
    };
}

QString SDKErrorManager::getErrorMessage(SDKError error, const QString& locale) const
{
    return getErrorInfo(error).getMessage(locale);
}

QString SDKErrorManager::getErrorSuggestion(SDKError error, const QString& locale) const
{
    return getErrorInfo(error).getSuggestion(locale);
}

} // namespace MotionSDK
```

---

## 5. ä½¿ç”¨ç¤ºä¾‹

### 5.1 åŸºæœ¬ä½¿ç”¨

```cpp
#include "SDKErrorCode.h"
using namespace MotionSDK;

// ç¤ºä¾‹ 1: è¿”å›é”™è¯¯ç 
SDKError motionControlSDK::MC_Init(const QString& logDir)
{
    if (d->initialized) {
        return SDKError::AlreadyInitialized;
    }
    
    if (!SDKManager::GetInstance()->Init(logDir)) {
        return SDKError::InitFailed;
    }
    
    d->initialized = true;
    return SDKError::Success;
}

// ç¤ºä¾‹ 2: æ£€æŸ¥é”™è¯¯
SDKError err = sdk->MC_Init("./logs");
if (!SDKErrorManager::isSuccess(err)) {
    QString msg = SDKErrorManager::instance()->getErrorMessage(err);
    QString suggestion = SDKErrorManager::instance()->getErrorSuggestion(err);
    
    qCritical() << "åˆå§‹åŒ–å¤±è´¥:" << msg;
    qInfo() << "å»ºè®®:" << suggestion;
}
```

### 5.2 ä¿¡å·å‘å°„

```cpp
// æ—§ä»£ç 
emit MC_SigErrOccurred(-1, tr("SDKæœªåˆå§‹åŒ–"));

// æ–°ä»£ç 
void motionControlSDK::emitError(SDKError error) {
    ErrorInfo info = SDKErrorManager::instance()->getErrorInfo(error);
    emit MC_SigErrOccurred(
        static_cast<int>(error), 
        info.getMessage(d->currentLocale)
    );
    LOG_E("é”™è¯¯: {} - {}", 
          SDKErrorManager::formatErrorCode(error), 
          info.getMessage("en_US"));
}

// ä½¿ç”¨
if (!d->initialized) {
    emitError(SDKError::NotInitialized);
    return false;
}
```

### 5.3 é”™è¯¯å¤„ç†åŠ©æ‰‹å®

```cpp
// SDKMacros.h
#define SDK_RETURN_IF_ERROR(expr) \
    do { \
        SDKError __err = (expr); \
        if (!SDKErrorManager::isSuccess(__err)) { \
            return __err; \
        } \
    } while(0)

#define SDK_EMIT_IF_ERROR(sdk, error) \
    do { \
        if (!SDKErrorManager::isSuccess(error)) { \
            (sdk)->emitError(error); \
            return false; \
        } \
    } while(0)

// ä½¿ç”¨ç¤ºä¾‹
bool motionControlSDK::MC_moveXAxis(const MoveAxisPos& targetPos)
{
    SDKError err = d->checkPreconditions(true);
    SDK_EMIT_IF_ERROR(this, err);
    
    err = SDKManager::GetInstance()->Move2AbsXAxis(targetPos);
    SDK_EMIT_IF_ERROR(this, err);
    
    return true;
}
```

---

## 6. é›†æˆæŒ‡å—

### 6.1 æ–‡ä»¶ç»“æ„

```
src/sdk/
â”œâ”€â”€ error/
â”‚   â”œâ”€â”€ SDKErrorCode.h           # é”™è¯¯ç å®šä¹‰
â”‚   â”œâ”€â”€ SDKErrorCode.cpp         # é”™è¯¯ç®¡ç†å™¨å®ç°
â”‚   â””â”€â”€ SDKMacros.h              # é”™è¯¯å¤„ç†å®
â”œâ”€â”€ motionControlSDK.h
â”œâ”€â”€ motionControlSDK.cpp
â””â”€â”€ ...
```

### 6.2 é›†æˆæ­¥éª¤

#### æ­¥éª¤ 1: æ·»åŠ æ–‡ä»¶åˆ°é¡¹ç›®

åœ¨ `motionControlSDK.vcxproj` ä¸­æ·»åŠ :
```xml
<ClInclude Include="..\..\src\sdk\error\SDKErrorCode.h" />
<ClInclude Include="..\..\src\sdk\error\SDKMacros.h" />
<ClCompile Include="..\..\src\sdk\error\SDKErrorCode.cpp" />
```

#### æ­¥éª¤ 2: ä¿®æ”¹å…¬å…±å¤´æ–‡ä»¶

```cpp
// motionControlSDK.h
#include "error/SDKErrorCode.h"

class MOTIONCONTROLSDK_EXPORT motionControlSDK : public QObject
{
    Q_OBJECT
public:
    // ä¿®æ”¹è¿”å›å€¼ç±»å‹
    MotionSDK::SDKError MC_Init(const QString& logDir = QString());
    MotionSDK::SDKError MC_Connect2Dev(const QString& ip, quint16 port = 12355);
    // ...
    
signals:
    // é”™è¯¯ä¿¡å·ä¿æŒä¸å˜ï¼ˆå‘åå…¼å®¹ï¼‰
    void MC_SigErrOccurred(int errorCode, const QString& errorMessage);
    
private:
    void emitError(MotionSDK::SDKError error);
};
```

#### æ­¥éª¤ 3: ä¿®æ”¹å®ç°æ–‡ä»¶

```cpp
// motionControlSDK.cpp
#include "error/SDKErrorCode.h"
#include "error/SDKMacros.h"

using namespace MotionSDK;

SDKError motionControlSDK::MC_Init(const QString& logDir)
{
    if (d->initialized) {
        return SDKError::AlreadyInitialized;
    }
    
    // æ³¨å†Œå…ƒç±»å‹
    qRegisterMetaType<SDKError>("SDKError");
    qRegisterMetaType<MoveAxisPos>("MoveAxisPos");
    
    // åˆå§‹åŒ–...
    if (!SDKManager::GetInstance()->Init(logDir)) {
        emitError(SDKError::InitFailed);
        return SDKError::InitFailed;
    }
    
    d->initialized = true;
    return SDKError::Success;
}

void motionControlSDK::emitError(SDKError error)
{
    ErrorInfo info = SDKErrorManager::instance()->getErrorInfo(error);
    emit MC_SigErrOccurred(
        static_cast<int>(error), 
        info.getMessage(d->currentLocale)
    );
    LOG_E("é”™è¯¯: {} - {}", 
          SDKErrorManager::formatErrorCode(error), 
          info.name);
}
```

#### æ­¥éª¤ 4: ä¿®æ”¹ SDKManager

```cpp
// SDKManager.h
#include "error/SDKErrorCode.h"

class SDKManager {
public:
    // ä¿®æ”¹è¿”å›å€¼ç±»å‹
    MotionSDK::SDKError Connect2MotionDev(const QString& ip, unsigned short port);
    MotionSDK::SDKError Move2AbsXAxis(const MoveAxisPos& targetPos);
    // ...
};

// SDKManager.cpp
SDKError SDKManager::Connect2MotionDev(const QString& ip, unsigned short port)
{
    if (!m_initialized) {
        return SDKError::NotInitialized;
    }
    
    if (IsConnected()) {
        return SDKError::AlreadyConnected;
    }
    
    m_tcpClient->setIpAndPort(ip, port);
    m_tcpClient->connectToHost();
    
    return SDKError::Success;
}
```

---

## 7. å¤šè¯­è¨€æ”¯æŒ

### 7.1 æ·»åŠ æ–°è¯­è¨€

```cpp
struct ErrorInfo {
    QString message_zh;
    QString message_en;
    QString message_ja;  // æ–°å¢æ—¥è¯­
    
    QString getMessage(const QString& locale = "zh_CN") const {
        if (locale == "zh_CN") return message_zh;
        if (locale == "en_US") return message_en;
        if (locale == "ja_JP") return message_ja;
        return message_en;  // é»˜è®¤è‹±è¯­
    }
};

// åˆå§‹åŒ–é”™è¯¯è¡¨æ—¶æ·»åŠ æ—¥è¯­æ¶ˆæ¯
m_errorTable[SDKError::NotInitialized] = {
    SDKError::NotInitialized,
    "NotInitialized",
    "SDK æœªåˆå§‹åŒ–",
    "SDK not initialized",
    "SDKãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“",  // æ—¥è¯­
    // ...
};
```

### 7.2 åŠ¨æ€åˆ‡æ¢è¯­è¨€

```cpp
class motionControlSDK::Private {
public:
    QString currentLocale{"zh_CN"};
    
    void setLocale(const QString& locale) {
        if (locale == "zh_CN" || locale == "en_US" || locale == "ja_JP") {
            currentLocale = locale;
        }
    }
};

// å…¬å…± API
void motionControlSDK::setLanguage(const QString& locale) {
    d->setLocale(locale);
}
```

---

## 8. æµ‹è¯•æ–¹æ¡ˆ

### 8.1 å•å…ƒæµ‹è¯•

```cpp
// test_SDKErrorCode.cpp
#include <QtTest/QtTest>
#include "error/SDKErrorCode.h"

using namespace MotionSDK;

class TestSDKErrorCode : public QObject
{
    Q_OBJECT
    
private slots:
    void testErrorManager() {
        auto* mgr = SDKErrorManager::instance();
        QVERIFY(mgr != nullptr);
    }
    
    void testErrorInfo() {
        auto info = SDKErrorManager::instance()->getErrorInfo(SDKError::NotInitialized);
        QCOMPARE(info.code, SDKError::NotInitialized);
        QVERIFY(!info.message_zh.isEmpty());
        QVERIFY(!info.message_en.isEmpty());
    }
    
    void testErrorMessage() {
        QString msg_zh = SDKErrorManager::instance()->getErrorMessage(
            SDKError::NotConnected, "zh_CN");
        QString msg_en = SDKErrorManager::instance()->getErrorMessage(
            SDKError::NotConnected, "en_US");
        
        QCOMPARE(msg_zh, "è®¾å¤‡æœªè¿æ¥");
        QCOMPARE(msg_en, "Device not connected");
    }
    
    void testErrorCategory() {
        quint8 category = SDKErrorManager::getCategory(SDKError::NotConnected);
        QCOMPARE(category, 0x01);  // GeneralError
    }
    
    void testErrorModule() {
        quint8 module = SDKErrorManager::getModule(SDKError::NotConnected);
        QCOMPARE(module, 0x02);  // Connection
    }
    
    void testFormatErrorCode() {
        QString code = SDKErrorManager::formatErrorCode(SDKError::NotConnected);
        QCOMPARE(code, "0x01020001");
    }
};

QTEST_MAIN(TestSDKErrorCode)
#include "test_SDKErrorCode.moc"
```

### 8.2 é›†æˆæµ‹è¯•

```cpp
void testErrorIntegration() {
    motionControlSDK sdk;
    
    // æµ‹è¯•æœªåˆå§‹åŒ–é”™è¯¯
    SDKError err = sdk.MC_Connect2Dev("192.168.1.100");
    QCOMPARE(err, SDKError::NotInitialized);
    
    // åˆå§‹åŒ–åæµ‹è¯•
    err = sdk.MC_Init();
    QCOMPARE(err, SDKError::Success);
    
    // æµ‹è¯•é‡å¤åˆå§‹åŒ–
    err = sdk.MC_Init();
    QCOMPARE(err, SDKError::AlreadyInitialized);
}
```

---

## é™„å½•

### A. å®Œæ•´é”™è¯¯ç åˆ—è¡¨

å‚è§ `SDKErrorCode.h` ä¸­çš„ `SDKError` æšä¸¾å®šä¹‰ã€‚

### B. é”™è¯¯ç é€ŸæŸ¥è¡¨

| é”™è¯¯ç  | åç§° | ä¸­æ–‡æ¶ˆæ¯ |
|--------|------|----------|
| 0x00000000 | Success | æ“ä½œæˆåŠŸ |
| 0x01010003 | NotInitialized | SDK æœªåˆå§‹åŒ– |
| 0x01020001 | NotConnected | è®¾å¤‡æœªè¿æ¥ |
| 0x01020004 | ConnectionTimeout | è¿æ¥è¶…æ—¶ |
| 0x01030002 | PositionOutOfRange | ä½ç½®è¶…å‡ºèŒƒå›´ |
| 0x01040001 | PrintStartFailed | å¯åŠ¨æ‰“å°å¤±è´¥ |
| 0x01050002 | InvalidIP | IP åœ°å€æ— æ•ˆ |
| 0x01060001 | CommandTimeout | å‘½ä»¤è¶…æ—¶ |
| 0x03000007 | LimitSwitchTriggered | è§¦å‘é™ä½å¼€å…³ |

### C. é”™è¯¯ç åˆ†é…è§„åˆ™

1. **æˆåŠŸ**: 0x00000000
2. **ä¸€èˆ¬é”™è¯¯**: 0x01XXXXXX
3. **ç³»ç»Ÿé”™è¯¯**: 0x02XXXXXX
4. **ç¡¬ä»¶é”™è¯¯**: 0x03XXXXXX
5. **åè®®é”™è¯¯**: 0x04XXXXXX
6. **ç”¨æˆ·é”™è¯¯**: 0x05XXXXXX
7. **é¢„ç•™**: 0x06XXXXXX - 0xFFXXXXXX

---

**æ–‡æ¡£ç»“æŸ**

**ç»´æŠ¤è€…**: Development Team  
**æœ€åæ›´æ–°**: 2026-01-20  
**ç‰ˆæœ¬**: 1.0

